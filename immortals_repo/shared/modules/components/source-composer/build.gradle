apply plugin: immortals.CoreDefinitions
apply plugin: immortals.Java8Component
apply plugin: immortals.PublishJavaDfu

jar {
    manifest {
        attributes "Implementation-Title": "SourceComposer",
                "Implementation-Version": defaultSoftwarePublishVersion,
                "Main-Class": "mil.darpa.immortals.das.sourcecomposer.Main"

    }

    from {
        configurations.compile.filter { !it.name.endsWith("android.jar") }.collect {
            it.isDirectory() ? it : zipTree(it)
        }
    }
}

clean.doLast {
    file("source-composer-all-${defaultSoftwarePublishVersion}.jar").delete()
}

dependencies {
    compile 'dom4j:dom4j:1.6.1'
    compile 'org.apache.commons:commons-csv:1.1'
    compile 'commons-io:commons-io:1.4'
    compile 'io.airlift:airline:0.7'
    compile project(':components:bundles:product-data-generator-bundle')
    compile project(':components:bundles:product-analysis-bundle-base')
    compile project(':components:bundles:product-analysis-bundle-android')
    compile project(':components:bundles:android-dummy-files')
    compile project(':dfus:LocationProviderAndroidGpsBuiltIn')
    compile project(':dfus:LocationProviderBluetoothGpsSimulated')
    compile project(':dfus:LocationProviderManualSimulated')
    compile project(':dfus:LocationProviderSaasmSimulated')
    compile project(':dfus:LocationProviderUsbGpsSimulated')
    compile project(':dfus:ImageUtilsAndroid')
    compile project(':components:build-bridge')
}
